package com.jsp.footmap.controller;import com.jsp.footmap.service.MapService;import com.jsp.footmap.utils.Response;import com.jsp.footmap.utils.jsonUtils;import org.slf4j.Logger;import org.slf4j.LoggerFactory;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.stereotype.Controller;import org.springframework.web.bind.annotation.*;import java.util.Map;@Controller@RequestMapping("/map")public class MapController {    private static final Logger logger = LoggerFactory.getLogger(MapController.class);    @Autowired    private MapService mapService;    /**     * 插入地图元素（时间地点）     * @return     */    @RequestMapping(path = "/addPlace", method = {RequestMethod.POST})    @ResponseBody    public Response addPlace(@RequestBody String jsonStr, @CookieValue("auth_token") String auth_token) {       try {           Map<String, String> jsonMap = jsonUtils.StrToMap(jsonStr);           String currentTime = jsonMap.get("currentTime");           String currentPlace = jsonMap.get("currentPlace");           Map<String, String> map = mapService.addCurrPlace(currentTime, currentPlace, auth_token);           if (map.get("msg").equals("新增成功")) {               return new Response(0, map.get("msg"));           } else {               return new Response(1, map.get("msg"));           }       } catch (Exception e) {           logger.error("addPlace:" + e.getMessage());           return new Response(1, "新增地点失败");       }    }    /**     * 返回某一天足迹地图     * 要求时间格式必须为 2019-12-11; YYYY-MM-DD 不可带时间     * @param selectTime 某一天     * @param auth_token     * @return     *     * todo: 之前设置数据库时区+8：00 导致返回结果少8小时。 若修改代码，服务器mysql必须设置为美国时区，同+8：00     */    @RequestMapping(path = "/getUserMap", method = {RequestMethod.GET})    @ResponseBody    public Response getPlace(@RequestParam("selectTime") String selectTime, @CookieValue("auth_token") String auth_token) {        try {            return mapService.getUserMap(selectTime, auth_token);        } catch (Exception e){            logger.error("getPlace:" + e.getMessage());            return new Response(1, "获取地图失败");        }    }}