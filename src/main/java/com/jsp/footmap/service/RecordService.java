package com.jsp.footmap.service;import com.jsp.footmap.dao.RecordDao;import com.jsp.footmap.dao.TokenDao;import com.jsp.footmap.model.Record;import com.jsp.footmap.model.Token;import com.jsp.footmap.utils.DateUtils;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.stereotype.Service;import org.springframework.util.StringUtils;import java.text.SimpleDateFormat;import java.util.Date;import java.util.HashMap;import java.util.List;import java.util.Map;@Servicepublic class RecordService {    @Autowired    private TokenDao tokenDAO;    @Autowired    private RecordDao recordDAO;    public Map<String,String> addRecord(String targetTime, String remarks, String targetPlace, String auth_token) {        Map<String ,String > map = new HashMap<String ,String >();        if (StringUtils.isEmpty(targetTime)) {            map.put("msg", "时间不能为空");            return map;        }        if (StringUtils.isEmpty(targetPlace)) {            map.put("msg", "地点不能为空");            return map;        }        Record userRecord = new Record();        Date date = DateUtils.StringToDate3(targetTime);        Token token = tokenDAO.selectByToken(auth_token);        userRecord.setUid(token.getUid());        userRecord.setRemarks(remarks);        userRecord.setTargetPlace(targetPlace);        userRecord.setTargetTime(date);        recordDAO.addRecord(userRecord);        map.put("msg", "新增成功");        return map;    }    /**     * 时间地点匹配后，返回提醒     * @param currentPlace     * @param auth_token     */    public boolean isOk(String currentPlace, String auth_token) {        Token token = tokenDAO.selectByToken(auth_token);        List<Record> records = recordDAO.getRecordByUid(token.getUid(), currentPlace);        //获取现在的时间        Date date = new Date();        Date currentDate = DateUtils.StringToDate3(DateUtils.DateToString(date));        for (Record r : records) {            String targetTime = DateUtils.DateToString(r.getTargetTime());            String currentTime = DateUtils.DateToString(currentDate);            System.out.println("目标:" + targetTime + ": 现在:" + currentTime);            if (targetTime.equals(currentTime)) {                return true;            }        }        return false;    }}